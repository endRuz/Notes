# dotnet CLI

- [dotnet CLI](#dotnet-cli)
  - [dotnet new](#dotnet-new)
  - [dotnet sln](#dotnet-sln)
  - [dotnet add/list/remove package](#dotnet-addlistremove-package)
    - [dotnet add package](#dotnet-add-package)
    - [dotnet list package](#dotnet-list-package)
    - [dotnet remove package](#dotnet-remove-package)
  - [dotnet add/list/remove reference](#dotnet-addlistremove-reference)
    - [dotnet add reference](#dotnet-add-reference)
    - [dotnet list reference](#dotnet-list-reference)
    - [dotnet remove reference](#dotnet-remove-reference)
  - [dotnet restore](#dotnet-restore)


## dotnet new

```powershell
mkdir GetStarted
cd GetStarted
# Create a solution named GetStarted
dotnet new sln -n GetStarted
# Create a console project named App
dotnet new console -n App
# Create .gitignore file to ignore Visual Studio temporary files, build results, and files generated by popular Visual Studio add-ons.
dotnet new gitignore
# Create global.json
dotnet new globaljson --sdk-version 6.0.310
# List all templates which you can create
dotnet new list
```

In .Net, a solution can contains one or many projects.

Solution uses two file types (*.sln* and *.suo*) to store settings for solutions.

Each project contains an project file. The file extension reflects the type of project, for example:
- C# project (*.csproj*)
- Visual Basic project (*.vbproj*)
- database project (*.dbproj*)

## dotnet sln

```powershell
# Add project to the solution
dotnet sln .\GetStarted.sln add .\App\App.csproj
# List all projects in a solution file
dotnet sln list
# Remove project from the solution
dotnet sln .\GetStarted.sln remove .\App\App.csproj
```

In fact, command `dotnet sln` can do less than Visual Studio. We can only add projects and not other files (e.g., `.gitignore`, `README.md` ...).

Hope Microsoft can enhance it in the future.

In Visual Studio, we can right click solution -> `Add` -> `Existing Item...` or `New Item...` to add or create your file.

## dotnet add/list/remove package

There are many methods to manage package:

- Visual Studio
- Package Manager Console (PowerShell)
- NuGet CLI
- dotnet CLI

Only dotnet Cli is introduced here.

### dotnet add package

Using `dotnet add package` to add or update a package reference in a project file.

```powershell
# Add Microsoft.EntityFrameworkCore NuGet package to a project:
dotnet add package Microsoft.EntityFrameworkCore
# Add a specific version of a package to a project:
dotnet add App.csproj package Microsoft.Azure.DocumentDB.Core -v 1.0.0
# Add a package using a specific NuGet source:
dotnet add package Microsoft.AspNetCore.StaticFiles -s https://dotnet.myget.org/F/dotnet-core/api/v3/index.json
```

After running the command, the `.csproj` file contains a `<PackageReference>` element for the referenced package.

```xml
<ItemGroup>
    <PackageReference Include="Microsoft.EntityFrameworkCore" Version="7.0.4" />
</ItemGroup>
```

### dotnet list package

Using `dotnet list package` to list the package references for a project or solution.

```powershell
dotnet list package
Project 'App' has the following package references
   [net6.0]:
   Top-level Package                    Requested   Resolved
   > Microsoft.EntityFrameworkCore      7.0.4       7.0.4
```

### dotnet remove package

Using `dotnet remove package` to remove package reference from a project file.

```powershell
dotnet remove package Microsoft.EntityFrameworkCore
```

## dotnet add/list/remove reference

### dotnet add reference

Using `dotnet add reference` to add project-to-project (P2P) references.

```powershell
dotnet new console -n App
dotnet new classlib -n Lib
dotnet sln add .\App\App.csproj .\Lib\Lib.csproj
dotnet add .\App\App.csproj reference .\Lib\Lib.csproj
```

After running the command, the `<ProjectReference>` elements are added to the project file.

```xml
<ItemGroup>
    <ProjectReference Include="..\Lib\Lib.csproj" />
</ItemGroup>
```

Try to add some code into the projects:

`.\Lib\Class1.cs`
```C#
namespace Lib;
public static class Class1
{
    public static void SayHello()
    {
        Console.WriteLine("Hello, here is Lib.Class1.SayHello");
    }
}

```

`.\App\Program.cs`
```C#
using Lib;

Class1.SayHello();
```

The output is:

```log
Hello, here is Lib.Class1.SayHello
```

There's no CLI command to add a reference to an assembly that isn't in a project or a package. But you can do that by editing your `.csproj` file and adding markup similar to the following example:

```xml
<ItemGroup>
  <Reference Include="MyAssembly">
    <HintPath>".\MyDLLFolder\MyAssembly.dll</HintPath>
  </Reference>
</ItemGroup>
```

### dotnet list reference

Using `dotnet list reference` to list project-to-project references.

```powershell
# List the project references for the specified project
> dotnet list .\App\App.csproj reference
Project reference(s)
--------------------
..\Lib\Lib.csproj
# List the project references for the project in the current directory:
> cd App
> dotnet list reference
Project reference(s)
--------------------
..\Lib\Lib.csproj
```

### dotnet remove reference

Using `dotnet remove reference` to remove project-to-project (P2P) references.

```powershell
dotnet remove .\App\App.csproj reference .\Lib\Lib.csproj
```

## dotnet restore

The `dotnet restore` command uses NuGet to restore dependencies as well as project-specific tools that are specified in the project file. In most cases, you don't need to explicitly use the `dotnet restore` command, since a NuGet restore is run implicitly if necessary when you run the following commands:

- `dotnet new`
- `dotnet build`
- `dotnet build-server`
- `dotnet run`
- `dotnet test`
- `dotnet publish`
- `dotnet pack`
